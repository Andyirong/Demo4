# Branch Archive Skill

## 描述
自动化归档已完成的功能分支，创建标准化的归档文档并生成新的开发分支。

## 功能特性
- ✅ 自动分析分支变更内容
- ✅ 生成动态的归档文档
- ✅ 创建标准的归档目录结构
- ✅ 支持提交并推送到远程
- ✅ 自动创建新的开发分支（demo4-XXX 格式）
- ✅ 支持斜杠命令调用

## 使用方法

### 斜杠命令
```bash
# 归档当前分支（默认行为）
/archive

# 只归档，不推送也不创建新分支
/archive --push=false --new-branch=false

# 归档并推送，但不创建新分支
/archive --new-branch=false

# 归档时为新建分支添加描述
/archive --description="修复登录页面的样式问题"

# 归档指定分支
/archive-branch demo4-003
```

### 自然语言调用
```
请帮我归档当前分支
归档 demo4-003 分支
创建分支归档
```

## 配置选项

| 参数 | 类型 | 默认值 | 描述 |
|------|------|--------|------|
| `push` | boolean | true | 是否提交并推送当前分支 |
| `newBranch` | boolean | true | 是否创建新的开发分支 |
| `description` | string | - | 新分支的描述信息 |
| `branchName` | string | 当前分支 | 要归档的分支名称（仅限 archive-branch 命令） |

## 归档结构
执行归档后，会在 `archives/` 目录下生成以下结构：
```
archives/demo4-XXX/
├── README.md                 # 归档概述
├── documentation/           # 文档目录
│   └── file-list.md         # 完整文件变更清单
└── meta/                    # 元信息目录
    └── git-info.txt         # Git 基本信息
```

## 技术实现

### 变更分析
- 自动识别提交类型：功能、修复、配置、文档、测试等
- 统计文件变更数量
- 分析文件类型（源代码、测试、文档等）

### 分支管理
- 自动获取下一个可用编号（demo4-XXX）
- **基于当前归档分支创建新分支**（保留所有配置和文件）
- 自动推送到远程仓库
- **只创建分支，不自动创建 Pull Request**

### 兼容性
- 支持 Git 2.x+ 版本
- 兼容旧版 Git 命令
- 错误处理和回退机制

## 示例输出
```
🚀 开始分支归档流程...

📦 归档分支: demo4-003
📝 最新提交: a3fe6ce3601c060456a1b0078988778098f51e5c
✅ 归档完成: archives/demo4-003
📤 已推送到远程仓库
✅ 新分支 demo4-004 已创建并推送
💡 分支已准备好进行开发，不会自动创建 PR

✅ 分支归档成功完成！
```